var referenceValueHasChanges=false;var disciplineUsersHasChanges=false;var previousReferenceType;var previousDiscipline;var systemValues;$(function(){$("#ReferenceValueDisabled").livequery(function(){$(this).bind("listschanged",function(){referenceValueHasChanges=true;$("#ReferenceValueDisabled option").each(function(){if($.inArray($(this).val(),systemValues)>-1){if($(this).val()!="MIGRATION"){$(this).remove();if($("#ReferenceValueEnabled option").length>0){$("#ReferenceValueEnabled option").eq(0).before("<option>"+$(this).val()+"</option>")}else{$("#ReferenceValueEnabled").append("<option>"+$(this).val()+"</option>")}alert($(this).val()+" option cannot be disabled.")}}});$("#ReferenceValueEnabled option").each(function(){if($(this).val()=="MIGRATION"){$(this).remove();if($("#ReferenceValueDisabled option").length>0){$("#ReferenceValueDisabled option").eq(0).before("<option>"+$(this).val()+"</option>")}else{$("#ReferenceValueDisabled").append("<option>"+$(this).val()+"</option>")}alert($(this).val()+" option cannot be enabled.");return false}})})});$(".lesson-action").click(function(){$("#ReferenceValueEnabled, #ReferenceValueDisabled, #DisciplineUsers").each(function(){if($(this).attr("mvcType")!="true"){$("option",this).attr("selected","selected")}});$("#AdminForm").submit()});$(".multi-add").live("click",function(){var c=$(this).attr("data-inputId");var b=$(this).attr("data-listId");var a=$(this).attr("data-disabledListId");AddElementToLeftList(c,b,a);return false});$("#AddDisciplineUser").live("click",function(){disciplineUsersHasChanges=true;var c=$("#BpoUsers").selectmenu("value");var b=$("#BpoUsers").selectmenu("text");if(c!=""){var a=false;$("#DisciplineUsers option").each(function(){if(this.value==c){a=true;return false}});if(!a){$("#DisciplineUsers").append('<option value="'+c+'">'+b+"</option>")}else{$("#AddDisciplineUserWarning").show("pulsate",null,100,function(){setTimeout(function(){$(".value-exists:visible").removeAttr("style").fadeOut(1000)},1000)})}}return false});$("#RemoveDisciplineUser").live("click",function(){$("#DisciplineUsers option:selected").remove()});$("#PrimaryDisciplineUser").live("click",function(){if($("#DisciplineUsers option:selected").length==1){$("#PrimaryBpoName").val($("#DisciplineUsers option:selected").html());$("#PrimaryDisciplineUser").val($("#DisciplineUsers option:selected").val())}});$(".reference-list-entry").livequery(function(){$(this).keydown(function(a){if(a.which==13){a.preventDefault();AddElementToLeftList($(this).attr("id"),$(this).attr("data-listId"),$(this).attr("disabledListId"))}})});$(".use-select-menu").selectmenu();previousReferenceType=$("#EditReferenceType").selectmenu("value");previousDiscipline=$("#EditingDisciplineUsersReferenceValue").selectmenu("value");$("#EditReferenceType").change(function(){if(referenceValueHasChanges){$("<div>You must save your changes before Administrating another list.  Click Cancel if you wish to save your changes.</div>").dialog({modal:true,width:300,title:"Unsaved Changes!",draggable:false,resizable:false,buttons:{"Discard Changes":function(){$(this).dialog("close");UpdateReferenceList()},Cancel:function(){$("#EditReferenceType").selectmenu("value",previousReferenceType);$(this).dialog("close")}}}).dialog("open")}else{UpdateReferenceList()}});$("#EditingDisciplineUsersReferenceValue").change(function(){if(disciplineUsersHasChanges){$("<div>You must save your changes before Administrating another list.  Click Cancel if you wish to save your changes.</div>").dialog({modal:true,width:300,title:"Unsaved Changes!",draggable:false,resizable:false,buttons:{"Discard Changes":function(){$(this).dialog("close");UpdateDisciplineUserList()},Cancel:function(){$("#EditingDisciplineUsersReferenceValue").selectmenu("value",previousDiscipline);$(this).dialog("close")}}}).dialog("open")}else{UpdateDisciplineUserList()}});$("#AssignPrimaryAdministrator").live("click",function(){if($("#AdminUsers option:selected").length==1){$("#PrimaryAdminName").val($("#AdminUsers option:selected").html());$("#PrimaryAdminUser").val($("#AdminUsers option:selected").val())}});$("#SendMail").click(function(){$("<div>Are you sure you wish to send these notifications?</div>").dialog({modal:true,width:300,title:"Send Notifications?",draggable:false,resizable:false,buttons:{"Send Notifications":function(){$(this).dialog("close");$("#AdminSendNotificationsForm").submit()},Cancel:function(){$(this).dialog("close")}}}).dialog("open")})});function UpdateReferenceList(){$.ajax({url:siteRoot+"Admin/EditReferenceValues",type:"GET",dataType:"html",data:{referenceType:$("#EditReferenceType").selectmenu("value"),noCache:Date()},success:function(a){$("#EditReferenceValueTarget").html(a);referenceValueHasChanges=false;previousReferenceType=$("#EditReferenceType").selectmenu("value")}})}function UpdateDisciplineUserList(){$.ajax({url:siteRoot+"Admin/EditBpoUsers",type:"GET",dataType:"html",data:{disciplineId:$("#EditingDisciplineUsersReferenceValue").selectmenu("value"),noCache:Date()},success:function(a){$("#EditBpoUsersTarget").html(a);disciplineUsersHasChanges=false;previousDiscipline=$("#EditingDisciplineUsersReferenceValue").selectmenu("value")}})}function AddElementToLeftList(c,e,a){var d=$("#"+c).val();if(d!=""){var b=false;$("#"+e+" option").each(function(){if(this.text==d){b=true;return false}});$("#"+a+" option").each(function(){if(this.text==d){b=true;return false}});if(!b){$("#"+e).append("<option>"+d+"</option>");$("#"+c).val("")}else{$(".value-exists[data-parentInputId='"+c+"']").show("pulsate",null,100,function(){setTimeout(function(){$(".value-exists:visible").removeAttr("style").fadeOut(1000)},1000)})}}}function InitializeLeftRightList(a,b){$("#"+a+" option").removeAttr("selected");$("#"+a+"__CopyRight").click(function(){$("#"+a+" option:selected").appendTo("#"+b);$("#"+b).trigger("listschanged")});$("#"+a+"__CopyLeft").click(function(){$("#"+b+" option:selected").appendTo("#"+a);$("#"+b).trigger("listschanged")});$("#"+a+"__CopyAllRight").click(function(){$("#"+a+" option").appendTo("#"+b);$("#"+b).trigger("listschanged")});$("#"+a+"__CopyAllLeft").click(function(){$("#"+b+" option").appendTo("#"+a);$("#"+b).trigger("listschanged")});$("#"+a+"__MoveUpLeft").click(function(){$("#"+a+" option:selected").each(function(){$(this).insertBefore($(this).prev())});$("#"+b).trigger("listschanged")});$("#"+a+"__MoveDownLeft").click(function(){$("#"+a+" option:selected").each(function(){$(this).insertAfter($(this).next())});$("#"+b).trigger("listschanged")});$("#"+a+"__MoveUpRight").click(function(){$("#"+b+" option:selected").each(function(){$(this).insertBefore($(this).prev())});$("#"+b).trigger("listschanged")});$("#"+a+"__MoveDownRight").click(function(){$("#"+b+" option:selected").each(function(){$(this).insertAfter($(this).next())});$("#"+b).trigger("listschanged")})};